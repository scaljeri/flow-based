!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("tslib"),require("@angular/platform-browser"),require("@angular/common")):"function"==typeof define&&define.amd?define("flow-based",["exports","@angular/core","@angular/forms","tslib","@angular/platform-browser","@angular/common"],e):e(t["flow-based"]={},t.ng.core,t.ng.forms,t.tslib,t.ng.platformBrowser,t.ng.common)}(this,function(t,e,n,r,o,i){"use strict";var s=new e.InjectionToken("xxl-flow-types"),a=function(){};a.decorators=[{type:e.Injectable}],a.ctorParameters=function(){return[]};var p=new e.InjectionToken("xxl-flow-entry"),c=function(){function t(t,e,n,o){this.element=t,this.service=e,this.injector=n,this.flowTypes=o}return t.prototype.ngOnInit=function(){},t.prototype.ngOnChanges=function(){},t.prototype.createInjector=function(t){if(this.state)return e.Injector.create({providers:[{provide:p,useValue:t}],parent:this.injector})},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(){},t.prototype.writeValue=function(t){this.state=t},t}();c.decorators=[{type:e.Component,args:[{selector:"xxl-flow-based",template:'<article #area *ngIf="state" class="is-max" xxlMovableArea>\n  <h1>Flow</h1>\n  <xxl-block xxlMovable *ngFor="let entry of state.entries"\n             [style.left.px]="entry.x - 46" [style.top.px]="entry.y - 40" class="block">\n    <ng-container *ngIf="flowTypes[entry.type]"\n                  [ngComponentOutlet]="flowTypes[entry.type]"\n                  [ngComponentOutletInjector]="createInjector(entry)"></ng-container>\n  </xxl-block>\n</article>\n',styles:[":host{display:block;margin:20px;border:4px solid #bada55;height:calc(100% - 48px);overflow:hidden}article{height:100%}"],providers:[{provide:n.NG_VALUE_ACCESSOR,useExisting:e.forwardRef(function(){return c}),multi:!0}]}]}],c.ctorParameters=function(){return[{type:e.ElementRef},{type:a},{type:e.Injector},{type:undefined,decorators:[{type:e.Inject,args:[s]}]}]},c.propDecorators={area:[{type:e.ViewChild,args:["area"]}]};var u=function(){function t(t){this.state=t}return t.prototype.ngOnInit=function(){},t}();u.decorators=[{type:e.Component,args:[{selector:"xxl-source",template:"<p>\n  Source: {{state.state}}\n</p>\n",styles:[""]}]}],u.ctorParameters=function(){return[{type:undefined,decorators:[{type:e.Inject,args:[p]}]}]};var l=function(){function t(t){this.state=t}return t.prototype.ngOnInit=function(){},t}();l.decorators=[{type:e.Component,args:[{selector:"xxl-dummy",template:"<p>\n  Dummy: {{state.state}}\n</p>\n\n",styles:[":host{display:flex;height:100%;background-color:#d3d3d3}"]}]}],l.ctorParameters=function(){return[{type:undefined,decorators:[{type:e.Inject,args:[p]}]}]};var g=function(){function t(t){this.element=t}return t.prototype.ngOnInit=function(){},t}();g.decorators=[{type:e.Component,args:[{selector:"xxl-block",template:'<div class="socket top"></div>\n<div class="socket right"></div>\n<div class="socket bottom"></div>\n<div class="socket left"></div>\n\n<ng-content></ng-content>\n',styles:[":host{background-color:#000;width:100px;height:100px;border:2px solid #a9a9a9;display:block;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:move;position:absolute;padding:3px;overflow:hidden}.socket{position:absolute}"]}]}],g.ctorParameters=function(){return[{type:e.ElementRef}]};var d=function(){function t(){this.dragStart=new e.EventEmitter,this.dragMove=new e.EventEmitter,this.dragEnd=new e.EventEmitter,this.draggable=!0,this.isDragging=!1}return t.prototype.onPointerDown=function(t){t.stopPropagation(),this.dragState=t},t.prototype.onPointerUp=function(t){this.isDragging&&this.dragEnd.emit(t),this.dragState=null,this.isDragging=!1},t.prototype.onPointerMove=function(t){this.dragState&&(this.isDragging||(this.dragStart.emit(this.dragState),this.isDragging=!0),this.dragMove.emit(t))},t}();d.decorators=[{type:e.Directive,args:[{selector:"[xxlDraggable]"}]}],d.propDecorators={dragStart:[{type:e.Output}],dragMove:[{type:e.Output}],dragEnd:[{type:e.Output}],draggable:[{type:e.HostBinding,args:["class.draggable"]}],onPointerDown:[{type:e.HostListener,args:["pointerdown",["$event"]]}],onPointerUp:[{type:e.HostListener,args:["document:pointerup",["$event"]]}],onPointerMove:[{type:e.HostListener,args:["document:pointermove",["$event"]]}]};var f=function(o){function t(t,e){var n=o.call(this)||this;return n.element=t,n.sanitzier=e,n.position={x:0,y:0},n}return r.__extends(t,o),Object.defineProperty(t.prototype,"transform",{get:function(){return this.sanitzier.bypassSecurityTrustStyle("translateX("+this.position.x+"px) translateY("+this.position.y+"px)")},enumerable:!0,configurable:!0}),t.prototype.onDragStart=function(t){this.startPosition={x:t.clientX-this.position.x,y:t.clientY-this.position.y}},t.prototype.onDragMove=function(t){this.position={x:t.clientX-this.startPosition.x,y:t.clientY-this.startPosition.y}},t.prototype.onDragEnd=function(t){},t}(d);f.decorators=[{type:e.Directive,args:[{selector:"[xxlMovable]"}]}],f.ctorParameters=function(){return[{type:e.ElementRef},{type:o.DomSanitizer}]},f.propDecorators={transform:[{type:e.HostBinding,args:["style.transform"]}],onDragStart:[{type:e.HostListener,args:["dragStart",["$event"]]}],onDragMove:[{type:e.HostListener,args:["dragMove",["$event"]]}],onDragEnd:[{type:e.HostListener,args:["dragEnd",["$event"]]}]};var y=function(){function t(t){this.element=t,this.subscriptions=[]}return t.prototype.ngAfterContentInit=function(){var e=this;this.movables.changes.subscribe(function(){e.subscriptions.forEach(function(t){return t.unsubscribe()}),e.subscriptions=[],e.movables.forEach(function(t){e.subscriptions.push(t.dragStart.subscribe(function(){return e.measureBoundaries(t)})),e.subscriptions.push(t.dragMove.subscribe(function(){return e.maintainBoundaries(t)}))})}),this.movables.notifyOnChanges()},t.prototype.measureBoundaries=function(t){var e=this.element.nativeElement.getBoundingClientRect(),n=t.element.nativeElement.getBoundingClientRect();this.boundaries={minX:e.left-n.left+t.position.x,maxX:e.right-n.right+t.position.x,minY:e.top-n.top+t.position.y,maxY:e.bottom-n.bottom+t.position.y}},t.prototype.maintainBoundaries=function(t){t.position.x=Math.max(this.boundaries.minX,t.position.x),t.position.x=Math.min(this.boundaries.maxX,t.position.x),t.position.y=Math.max(this.boundaries.minY,t.position.y),t.position.y=Math.min(this.boundaries.maxY,t.position.y)},t}();y.decorators=[{type:e.Directive,args:[{selector:"[xxlMovableArea]"}]}],y.ctorParameters=function(){return[{type:e.ElementRef}]},y.propDecorators={movables:[{type:e.ContentChildren,args:[f]}]};var m={source:l},h=function(){};h.decorators=[{type:e.NgModule,args:[{imports:[i.CommonModule],declarations:[c,u,l,g,d,f,y],exports:[c],providers:[{provide:s,useValue:m},a],entryComponents:[l,u]}]}],t.XXL_FLOW_ENTRY=p,t.FlowBasedComponent=c,t.FlowBasedModule=h,t.XXL_FLOW_TYPES=s,t.SourceComponent=u,t.ɵc=g,t.ɵb=l,t.ɵd=d,t.ɵf=y,t.ɵe=f,t.ɵa=a,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=flow-based.umd.min.js.map
